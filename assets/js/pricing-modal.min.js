((t,i)=>{t(i).on("click.imagify",".imagify-tab",function(i){var a=t(this),e="imagify-current";i.preventDefault(),a.hasClass("imagify-current")||(i=a.find("a").attr("href")||"#"+a.find("a").attr("aria-controls"),a.closest(".imagify-tabs").next(".imagify-tabs-contents").find(".imagify-tab-content").hide().attr("aria-hidden","true"),t(i).fadeIn(275).attr("aria-hidden","false"),a.closest(".imagify-tabs").find(".imagify-tab").removeClass(e).attr("aria-selected","false"),a.addClass(e).attr("aria-selected","true"))}),t("#imagify-toggle-plan").change(function(){var i=t(this).is(":checked");t(".imagify-toggle-label").eq(0).css("color",i?"#c8ced5":"#3b3f4a"),t(".imagify-toggle-label").eq(1).css("color",i?"#3b3f4a":"#c8ced5"),t(".imagify-badge").toggleClass("imagify-badge-checked",i),t("#imagify_all_plan_view").toggleClass("imagify-year-selected",i).toggleClass("imagify-month-selected",!i),t(".imagify-arrow-container img").eq(0).toggle(!i),t(".imagify-arrow-container img").eq(1).toggle(i)})})(jQuery,document,window),((b,i,k)=>{var _={};b("#imagify-pricing-modal").length&&((_={$modal:b("#imagify-pricing-modal"),$checkboxes:b(".imagify-offer-line .imagify-checkbox"),$radios:b(".imagify-payment-modal .imagify-radio-line input"),$preView:b("#imagify-pre-checkout-view").hide(),$plansView:b("#imagify-plans-selection-view"),$paymentView:b("#imagify-payment-process-view").hide(),$successView:b("#imagify-success-view").hide(),$anotherBtn:b(".imagify-choose-another-plan"),speedFadeIn:300,getHtmlPrice:function(i,a){var e,t;return a=a||null,"object"!=typeof i?((i=(i+="").split("."))[1]=1===i[1].length?i[1]+"0":(""+i[1]).substring(0,2),t='<span class="imagify-price-big">'+i[0]+"</span> ",t+('<span class="imagify-price-mini">.'+i[1])+"</span>"):(e=i.monthly+"",i=i.yearly+"",e="0"===e?["0","00"]:e.split("."),i="0"===i?["0","00"]:i.split("."),(t=(t=(t=(t='<span class="imagify-switch-my">')+'<span aria-hidden="'+("monthly"===a?"false":"true")+'" class="imagify-monthly"><span class="imagify-price-big">'+e[0]+"</span> ")+'<span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":(""+e[1]).substring(0,2))+"</span></span> ")+'<span aria-hidden="'+("yearly"===a?"false":"true")+'" class="imagify-yearly"><span class="imagify-price-big">'+i[0]+"</span> ")+'<span class="imagify-price-mini">.'+(1===i[1].length?i[1]+"0":(""+i[1]).substring(0,2))+"</span></span></span>")},getHtmlDiscountPrice:function(i,a){var e="";return a=a||null,e="object"==typeof i?(e=(e=(e+='<span class="imagify-price-discount"><span class="imagify-price-discount-dollar">$</span><span class="imagify-switch-my">')+'<span aria-hidden="'+("monthly"===a?"false":"true")+'" class="imagify-monthly"><span class="imagify-price-discount-number">'+(i.monthly+"")+"</span>")+'</span><span aria-hidden="'+("yearly"===a?"false":"true")+'" class="imagify-yearly">')+'<span class="imagify-price-discount-number">'+(i.yearly+"")+"</span></span></span></span>":(e+='<span class="imagify-price-discount"><span class="imagify-price-discount-dollar">$</span>')+'<span class="imagify-price-discount-number">'+(i+="")+"</span></span>"},populateOffer:function(i,a,e,t){var o,n=k.imagify_discount_datas,l=a.additional_gb,s=a.annual_cost,f=a.id,c=a.label,m=a.monthly_cost,r=a.quota,d=a.cost,a=a.label,g=-1===r?"Unlimited":1e3<=r?r/1e3+" GB":r+" MB",y="monthly"===e?{monthly:m,yearly:Math.round(s/12*100)/100}:d,p=y,u=[],h="",v="",u=_.getPromoAppliesTo(n);return n.is_active&&"percentage"===n.coupon_type&&"monthly"===e&&0<m&&(u.includes(c)||"all"===u[0])&&(o=(100-n.coupon_value)/100,y="monthly"===e?{monthly:m*o,yearly:Math.round(s*o/12*100)/100}:d*o),void 0!==t&&(i.addClass("imagify-"+e+"-"+c+t),i.addClass("imagify-"+e+"-"+c+t)),i.find(".imagify-label-plans").text(a),i.find(".imagify-offer-size").text(g),i.find(".imagify-number-block").html(_.getHtmlPrice(y,"monthly")),v="Unlimited"==g?(h="quota",i.addClass("imagify-best-value"),"No additional cost"):(h="/month","$"+l+" per additional Gb"),i.find(".imagify-offer-by").text(h),i.find(".imagify-price-block").prev(".imagify-price-discount").remove(),n.is_active&&"percentage"===n.coupon_type&&"monthly"===e&&0<m&&(u.includes(c)||"all"===u[0])&&i.find(".imagify-price-block").before(_.getHtmlDiscountPrice(p,"monthly")),i.find(".imagify-approx-nb").text(5*r),"monthly"===e&&i.find(".imagify-price-add-data").text(v),s=i.find(".imagify-payment-btn-select-plan").length?i.find(".imagify-payment-btn-select-plan"):i,d="monthly"===e?'{"'+c+'":{"id":'+f+',"name":"'+g+'","label":"'+c+'","data":'+r+',"dataf":"'+g+'","imgs":'+5*r+',"prices":{"monthly":'+y.monthly+',"yearly":'+y.yearly+',"add":'+l+"}}}":'{"ot'+c+'":{"id":'+f+',"name":"'+g+'","label":"'+c+'","data":'+r+',"dataf":"'+g+'","imgs":'+5*r+',"price":'+y+"}}",s.attr("data-offer",d),i},populatePayBtn:function(){var i,a=b(".imagify-offer-monthly"),e=b(".imagify-offer-onetime"),t=0,o=0;a.length&&(i=JSON.parse(a.attr("data-offer")),a.hasClass("imagify-offer-selected"))&&(t=b("#imagify-subscription-monthly").filter(":checked").length?i[Object.keys(i)[0]].prices.monthly:12*i[Object.keys(i)[0]].prices.yearly),e.length&&(a=JSON.parse(e.attr("data-offer")),e.hasClass("imagify-offer-selected"))&&(o=a[Object.keys(a)[0]].price),"0.00"===(i=parseFloat(o+t).toFixed(2))||0===i?b("#imagify-modal-checkout-btn").prop("disabled",!0).addClass("imagify-button-disabled"):b("#imagify-modal-checkout-btn").prop("disabled",!1).removeClass("imagify-button-disabled")},checkCoupon:function(){var i,o=b("#imagify-coupon-code").val(),n=b(".imagify-coupon-text"),l=n.find("label"),s=b(".imagify-coupon-section");""===o?(s.removeClass("validated").removeClass("invalid"),l.html(imagifyPricingModal.labels.defaultCouponLabel)):(i=b("#imagify-get-pricing-modal").data("nonce"),n.addClass("checking"),b.post(ajaxurl,{action:"imagify_check_coupon",coupon:o,imagifynonce:i},function(i){var a,e,t;n.removeClass("checking"),i.success?i.data.success?(a="percentage"===i.data.coupon_type?i.data.value+"%":"$"+i.data.value,e=b(".imagify-pre-checkout-view .imagify-pre-checkout-offers .imagify-offer-line"),e=JSON.parse(e.attr("data-offer")),(t=_.getPromoAppliesTo(i.data)).includes(e[Object.keys(e)[0]].label)||"all"===t[0]?(s.removeClass("invalid").addClass("validated"),l.html(imagifyPricingModal.labels.successCouponAPI),l.find(".imagify-coupon-offer").text(a),l.find(".imagify-coupon-word").text(o)):(s.removeClass("validated").addClass("invalid"),l.html(imagifyPricingModal.labels.errorCouponPlan),b("#imagify-coupon-code").val(""))):(s.removeClass("validated").addClass("invalid"),l.text(i.data.detail)):(s.removeClass("validated").addClass("invalid"),l.text(imagifyPricingModal.labels.errorCouponAPI))}))},getPricing:function(i){var i=i.data("nonce"),a={action:"imagify_get_prices",imagifynonce:i},e={action:"imagify_get_images_counts",imagifynonce:i},t={action:"imagify_get_discount",imagifynonce:i};_.$modal.find(".imagify-modal-loader").hide().show(),_.$modal.addClass("imagify-modal-loading"),b.post(ajaxurl,a,function(v){v.success&&b.post(ajaxurl,e,function(h){h.success&&b.post(ajaxurl,t,function(i){var a,e,t,o,n,l,s,f,c=25,m="",r="";if(i.success){if(f=h.data,p=v.data,a=i.data,e={mo:[],ot:[]},i={month:f.average_month_size.raw/Math.pow(1024,2),total:f.total_library_size.raw/Math.pow(1024,2)},t=b("#imagify-offer-monthly-template"),o=b("#imagify-offer-onetime-template"),n=o.html(),l=t.html(),s=b(".imagify-estimation-block"),b.each(p.monthlies,function(i,a){(void 0===a.active||void 0!==a.active&&!0===a.active)&&("free"===a.label&&(c=a.quota),"starter"!==a.label)&&e.mo.push(a)}),b.each(p.onetimes,function(i,a){(void 0===a.active||void 0!==a.active&&!0===a.active)&&e.ot.push(a)}),s.removeClass("imagify-analyzing"),s.find(".average-month-size").text(f.average_month_size.human),s.find(".total-library-size").text(f.total_library_size.human),i.total+i.month<c?b(".imagify-pre-checkout-offers .imagify-modal-title").addClass("imagify-enough-free"):b(".imagify-enough-free").removeClass("imagify-enough-free"),b(".imagify-offer-selected").removeClass("imagify-offer-selected").find(".imagify-checkbox").prop("checked",!1),null===e.mo||null===e.ot)(p=b(".imagify-pre-checkout-offers")).hide().attr("aria-hidden",!0),p.closest(".imagify-modal-views").find(".imagify-popin-message").remove(),p.after('<div class="imagify-popin-message imagify-error"><p>'+imagifyPricingModal.labels.errorPriceAPI+"</p></div>");else{if((k.imagify_discount_datas=a).is_active){if(a.applies_to instanceof Array){for(var d=[],g=[],y=0;y<a.applies_to.length;y++)g.push(a.applies_to[y].plan_name);g.forEach(function(i){d.includes(i)||d.push(i)}),d=d.join(", ")}else d=a.applies_to;s=b(".imagify-modal-promotion"),f=a.date_end.split("T")[0],p=a.coupon_value,p="percentage"===a.coupon_type?p+"%":"$"+p,s.addClass("active").attr("aria-hidden","false"),s.find(".imagify-promotion-number").text(p),s.find(".imagify-promotion-plan-name").text(d),s.find(".imagify-promotion-date").text(f)}var p,u=_.getSuggestedOffers(e,i,c);0===e.mo.length?(b(".imagify-pre-checkout-offers .imagify-offer-monthly").remove(),b(".imagify-tabs").remove(),b(".imagify-pricing-tab-monthly").remove()):(b.each(e.mo,function(i,a){if(2<i-u.mo.index)return!0;i=b(l).clone(),i=_.populateOffer(i,a,"monthly",""),r+=i[0].outerHTML}),setTimeout(function(){b(".imagify-best-value").prepend('<div class="imagify-ribbon"><span>Best Value!</span></div>')},100)),0===e.ot.length?(b(".imagify-pre-checkout-offers .imagify-offer-onetime").remove(),b(".imagify-tabs").remove(),b(".imagify-pricing-tab-onetime").remove()):b.each(e.ot,function(i,a){var e="";i===u.ot.index&&(i=b(".imagify-pre-checkout-offers .imagify-offer-onetime"),u.ot.selected&&(e=" imagify-offer-selected",i.addClass("imagify-offer-selected").find(".imagify-checkbox").prop("checked",!0)),_.populateOffer(i,a,"onetime")),i=b(n).clone(),i=_.populateOffer(i,a,"onetime",e),m+=i[0].outerHTML}),a&&(((p=_.getPromoAppliesTo(a)).includes(u.mo.plan_label)||p.includes(u.ot.plan_label)||"all"===p[0])&&b("#imagify-coupon-code").val(a.label),a.is_active)&&_.checkCoupon(),t.parent().find(".imagify-offer-line")&&t.parent().find(".imagify-offer-line").remove(),t.before(r),o.parent().find(".imagify-offer-line")&&o.parent().find(".imagify-offer-line").remove(),o.before(m)}_.$modal.find(".imagify-modal-loader").fadeOut(300),_.$modal.removeClass("imagify-modal-loading")}})}),_.populatePayBtn()})},getSuggestedOffers:function(i,e,t){var o,n,a,l,s,f,c=e.total+e.month,m={quota:0},r={mo:!1,ot:!1};return i.ot.length<0&&(a=i.ot[i.ot.length-1].id,l=i.ot[i.ot.length-1].label),i.ot.length<0&&(s=i.mo[i.mo.length-1].id,f=i.mo[i.mo.length-1].label),b.each(i.mo,function(i,a){return a.quota<0&&(n={index:i,selected:1,plan_id:a.id,plan_label:a.label}),a.quota>m.quota&&(m={index:i,selected:1,quota:a.quota,plan_id:a.id,plan_label:a.label}),0===a.monthly_cost&&0===a.annual_cost||a.quota<=0&&e.month>a.quota||e.total>a.quota||0<=a.quota&&e.month<a.quota&&e.total<a.quota&&(void 0===o||o.quota>a.quota)&&(o=a,r.mo={index:i,selected:t>e.month&&t>e.total?0:1,plan_id:a.id,plan_label:a.label}),!0}),!1===r.mo&&(r.mo=void 0!==n?n:m),c-=i.mo[r.mo.index].quota,0!==i.ot.length&&(c<=0?(b.each(i.ot,function(i,a){return a.quota<e.total||!(r.ot={index:i,selected:0,plan_id:a.id,plan_label:a.label})}),!1===r.ot&&(r.ot={index:i.ot.length-1,selected:0,plan_id:a,plan_label:l})):(b.each(i.ot,function(i,a){return a.quota<c||!(r.ot={index:i,selected:1,plan_id:a.id,plan_label:a.label})}),!1===r.ot&&(r.ot={index:i.ot.length-1,selected:1,plan_id:a,plan_label:l},r.mo=!1,c=e.total+e.month-i.ot[r.ot.index].quota,b.each(i.mo,function(i,a){return a.quota<c||!(r.mo={index:i,selected:1,plan_id:a.id,plan_label:a.label})}),!1===r.mo)&&(r.mo={index:i.mo.length-1,selected:1,plan_id:s,plan_label:f}))),r},checkCheckbox:function(i){var a="imagify-offer-selected";i.each(function(){var i=b(this);i.is(":checked")?i.closest(".imagify-offer-line").addClass(a):i.closest(".imagify-offer-line").removeClass(a)}),_.populatePayBtn()},checkRadio:function(i){var t="imagify-year-selected",o="imagify-month-selected";return i.each(function(){var i=b(this),a=i.parent(".imagify-cart-list-switcher").length?i.closest(".imagify-cart"):i.parent(".imagify-small-options").length?i.parent(".imagify-small-options").next(".imagify-pricing-table"):i.closest(".imagify-offer-line"),e=a.find(".imagify-switch-my");"yearly"===i.val()?(a.addClass(t).removeClass(o),e.find(".imagify-monthly").attr("aria-hidden","true"),e.find(".imagify-yearly").attr("aria-hidden","false")):(a.addClass(o).removeClass(t),e.find(".imagify-monthly").attr("aria-hidden","false"),e.find(".imagify-yearly").attr("aria-hidden","true"))}),_.populatePayBtn(),i},populateBtnPrice:setInterval(function(){_.populatePayBtn()},1e3),getPeriod:function(){return b(".imagify-offer-monthly").hasClass("imagify-month-selected")?"monthly":"yearly"},getApiKey:function(){return b("#imagify-payment-iframe").data("imagify-api")},switchToView:function(i,a){var e=i.attr("id"),t=_.$modal.children(".imagify-modal-content");i.siblings(".imagify-modal-views").hide().attr("aria-hidden","true"),a&&a.tab&&i.find('a[href="#'+a.tab+'"]').trigger("click.imagify"),"imagify-payment-process-view"===e?t.addClass("imagify-iframe-viewing"):t.removeClass("imagify-iframe-viewing"),"imagify-success-view"===e?(t.addClass("imagify-success-viewing"),_.$modal.attr("aria-labelledby","imagify-success-view")):(t.removeClass("imagify-success-viewing"),_.$modal.removeAttr("aria-labelledby")),i.fadeIn(_.speedFadeIn).attr("aria-hidden","false")},iframeSetSrc:function(i){var a=b("#imagify-payment-iframe"),e=a.attr("src"),t=a.data("src"),o=0,n=0;"string"==typeof i&&""!==e?(e=e.replace("monthly"===i?"yearly":"monthly",i),a.attr("src",e)):"object"==typeof i&&(i.monthly&&(o=i.monthly[Object.keys(i.monthly)[0]].id),i.onetime&&(n=(n=i.onetime[Object.keys(i.onetime)[0]].id)+""=="999"?i.onetime[Object.keys(i.onetime)[0]].data:n),i.period?(t=t+n+"/"+("monthly"===i.period?o:0)+"/"+("yearly"===i.period?o:0)+"/"+(""===(e=b("#imagify-coupon-code").val())?"none":e)+"/",n=a.remove().attr("src",t),_.$paymentView.html(n)):k.imagify.info("No period defined"))},paymentClose:function(){b(".imagify-iframe-viewing .close-btn").trigger("click.imagify"),b(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing")},paymentBack:function(){_.switchToView(_.$preView)},paymentSuccess:function(){_.switchToView(_.$successView)},checkPluginMessage:function(i){var a=i.origin||i.originalEvent.origin;if(imagifyPricingModal.imagify_app_domain===a)switch(i.data){case"cancel":_.paymentClose();break;case"back":_.paymentBack();break;case"success":_.paymentSuccess()}},getPromoAppliesTo:function(i){var a=[];if(i.applies_to instanceof Array){for(var e=[],t=0;t<i.applies_to.length;t++)e.push(i.applies_to[t].plan_name);e.forEach(function(i){a.includes(i)||a.push(i)})}else a=[i.applies_to];return a}}).checkCheckbox(_.$checkboxes),_.checkRadio(_.$radios.filter(":checked")),_.checkCoupon(),_.$checkboxes.on("change.imagify",function(){_.checkCheckbox(b(this))}),_.$radios.on("change.imagify",function(){_.checkRadio(b(this))}),b(".imagify-get-pricing-modal").on("click.imagify-ajax",function(){_.getPricing(b(this))}),b(i).on("modalClosed.imagify",".imagify-payment-modal",function(){b("#imagify-coupon-code").val(""),b(this).find(".imagify-modal-content").removeClass("imagify-success-viewing imagify-iframe-viewing"),setTimeout(function(){b(".imagify-modal-views").hide(),b("#imagify-pre-checkout-view").hide(),b("#imagify-plans-selection-view").show()},300),setTimeout(function(){b(".imagify-payment-modal").find(".imagify-modal-content").scrollTop(0)},400)}),b("#imagify-coupon-code").on("blur.imagify",function(){b(this).attr("readonly")||_.checkCoupon()}).on("keydown.imagify",function(i){var a=b(this);if(!a.attr("readonly"))return 13===i.keyCode||32===i.keyCode?(_.checkCoupon(),!1):void(3<=a.val().length?a.closest(".imagify-coupon-input").addClass("imagify-canbe-validate"):a.closest(".imagify-coupon-input").removeClass("imagify-canbe-validate"))}),b("#imagify-coupon-validate").on("click.imagify",function(){_.checkCoupon(),b(this).closest(".imagify-canbe-validate").removeClass("imagify-canbe-validate")}),_.$anotherBtn.on("click.imagify",function(i){var a="imagify-pricing-tab-"+("plan"===b(this).data("imagify-choose")?"monthly":"onetime");i.preventDefault(),_.switchToView(_.$plansView,{tab:a})}),_.$modal.on("click.imagify",".imagify-payment-btn-select-plan",function(i){var a=b(this),e=a.closest(".imagify-offer-line"),t=a.data("offer"),o=a.attr("data-offer"),n="imagify-pricing-tab-monthly"!==a.closest(".imagify-tab-content").attr("id"),l=n?_.$preView.find(".imagify-offer-onetime"):_.$preView.find(".imagify-offer-monthly"),a=n?null:a.closest(".imagify-pricing-table").hasClass("imagify-month-selected")?"monthly":"yearly",s=n?_.getHtmlPrice(t[Object.keys(t)[0]].price):_.getHtmlPrice(t[Object.keys(t)[0]].prices,a),f=n?"":'<span class="imagify-price-by">'+e.find(".imagify-price-by").text()+"</span>",c=e.find(".imagify-price-discount").html(),m=e.find(".imagify-approx-nb").text(),r=e.find(".imagify-offer-size").text(),d=b("#imagify-coupon-code");i.preventDefault(),_.switchToView(_.$preView),l.find(".imagify-number-block").html(s+f),c?(l.find(".imagify-price-discount").length<=0&&l.find(".imagify-col-price").prepend('<span class="imagify-price-discount"></span>'),l.find(".imagify-price-discount").html(c),l.find(".imagify-price-discount").show()):l.find(".imagify-price-discount").hide(),l.find(".imagify-approx-nb").text(m),l.find(".imagify-offer-size").text(r),l.attr("data-offer",o),n||(l.find(".imagify-price-add-data").text(e.find(".imagify-price-add-data").text()),("monthly"===a?l.find("#imagify-subscription-monthly"):l.find("#imagify-subscription-yearly")).trigger("click.imagify"),l.find(".imagify-inline-options").find("input:radio:checked").trigger("change.imagify")),(d=b("#imagify-coupon-code")).val(""),k.imagify_discount_datas&&((i=_.getPromoAppliesTo(k.imagify_discount_datas)).includes(t[Object.keys(t)[0]].label)||"all"===i[0])&&d.val(k.imagify_discount_datas.label),_.checkCoupon(),_.populatePayBtn()}),b("#imagify-modal-checkout-btn").on("click.imagify",function(i){var a,e;i.preventDefault(),b(this).hasClass("imagify-button-disabled")||(i=b(".imagify-offer-monthly"),a=b(".imagify-offer-onetime"),e={},i.hasClass("imagify-offer-selected")&&(e.monthly=JSON.parse(i.attr("data-offer"))),a.hasClass("imagify-offer-selected")&&(e.onetime=JSON.parse(a.attr("data-offer"))),imagifyPricingModal.userDataCache&&b.post(ajaxurl,{action:imagifyPricingModal.userDataCache.deleteAction,_wpnonce:imagifyPricingModal.userDataCache.deleteNonce}),_.switchToView(_.$paymentView),e.period=_.getPeriod(),_.iframeSetSrc(e))}),b(".imagify-back-to-plans").on("click.imagify",function(i){var a=b(this).closest(".imagify-cart-item").hasClass("imagify-cart-item-onetime");i.preventDefault(),b(a?".imagify-offer-onetime":".imagify-offer-monthly").find(".imagify-choose-another-plan").trigger("click.imagify")}),k.addEventListener("message",_.checkPluginMessage,!0))})(jQuery,document,window);
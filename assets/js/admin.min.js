jQuery(function(a){var u=0<ajaxurl.indexOf("?")?"&":"?",C={log:function(a){"undefined"!==console&&console.log(a)},info:function(a){"undefined"!==console&&console.info(a)}};a("#imagify-signup").click(function(b){b.preventDefault();swal({title:imagifyAdmin.labels.signupTitle,text:imagifyAdmin.labels.signupText,confirmButtonText:imagifyAdmin.labels.signupConfirmButtonText,type:"input",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup"},
function(b){if(""==a.trim(b)||!b)return swal.showInputError(imagifyAdmin.labels.signupErrorEmptyEmail),!1;a.get(ajaxurl+u+"action=imagify_signup&email="+b+"&imagifysignupnonce="+a("#imagifysignupnonce").val()).done(function(a){a.success?swal({title:imagifyAdmin.labels.signupSuccessTitle,text:imagifyAdmin.labels.signupSuccessText,type:"success",customClass:"imagify-sweet-alert"}):swal.showInputError(a.data)})})});a("#imagify-save-api-key").click(function(b){b.preventDefault();swal({title:imagifyAdmin.labels.saveApiKeyTitle,
text:imagifyAdmin.labels.saveApiKeyText,confirmButtonText:imagifyAdmin.labels.saveApiKeyConfirmButtonText,type:"input",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,customClass:"imagify-sweet-alert imagify-sweet-alert-signup"},function(b){if(""==a.trim(b)||!b)return swal.showInputError(imagifyAdmin.labels.signupErrorEmptyEmail),!1;a.get(ajaxurl+u+"action=imagify_check_api_key_validity&api_key="+b+"&imagifycheckapikeynonce="+a("#imagifycheckapikeynonce").val()).done(function(a){a.success?
swal({title:imagifyAdmin.labels.ApiKeyCheckSuccessTitle,text:imagifyAdmin.labels.ApiKeyCheckSuccessText,type:"success",customClass:"imagify-sweet-alert"}):swal.showInputError(a.data)})})});a(".imagify-notice-dismiss").click(function(b){b.preventDefault();var c=a(this);b=c.parents(".imagify-welcome, .imagify-notice");c=c.attr("href");b.fadeTo(100,0,function(){a(this).slideUp(100,function(){a(this).remove()})});a.get(c.replace("admin-post.php","admin-ajax.php"))});a(".imagify-modal").attr("aria-hidden",
"true");a(".imagify-modal-trigger").on("click.imagify",function(){var b=a(this),b=b.data("target")||b.attr("href");a(b).css("display","flex").hide().fadeIn(400).attr("aria-hidden","false").attr("tabindex","0").focus().removeAttr("tabindex").addClass("modal-is-open");a("body").addClass("imagify-modal-is-open");return!1});a(document).on("click.imagify",".imagify-modal .close-btn",function(){a(this).closest(".imagify-modal").fadeOut(400).attr("aria-hidden","true").removeClass("modal-is-open");a(this).closest(".imagify-modal").hasClass("imagify-payment-modal")&&
(a(this).closest(".imagify-modal-content").removeClass("imagify-success-viewing").closest(".imagify-modal").attr("aria-labelledby","imagify-pricing-step-1"),setTimeout(function(){a(".imagify-modal-views").hide();a("#imagify-pre-checkout-view").show()},300));a("body").removeClass("imagify-modal-is-open")}).on("blur.imagify",".imagify-modal .close-btn",function(){var b=a(this).closest(".imagify-modal");"false"===b.attr("aria-hidden")&&b.attr("tabindex","0").focus().removeAttr("tabindex")});a(document).on("click.imagify",
".imagify-modal",function(b){a(b.target).filter(".modal-is-open").find(".close-btn").trigger("click.imagify")});a(window).on("keydown",function(b){if(27==b.keyCode&&0<a(".imagify-modal.modal-is-open").length)return b.preventDefault(),a(".imagify-modal.modal-is-open").find(".close-btn").trigger("click.imagify"),!1});var v=!1;a("#wp-admin-bar-imagify").hover(function(){if(!0!==v){v=!0;var b=a("#wp-admin-bar-imagify-profile-content");b.is(":empty")&&a.get(ajaxurl+u+"action=imagify_get_admin_bar_profile&imagifygetadminbarprofilenonce="+
a("#imagifygetadminbarprofilenonce").val()).done(function(c){b.html(c.data);a("#wp-admin-bar-imagify-profile-loading").remove();v=!1})}});if(a("#imagify-pricing-modal").length){var w=a("#imagify-pricing-modal"),x=function(a,c){c||(c=null);output="";if("object"===typeof a){var b=a.yearly+"",e=(a.monthly+"").split("."),b=b.split(".");output+='<span class="imagify-switch-my"><span aria-hidden="'+("monthly"===c?"false":"true")+'" class="imagify-monthly"><span class="imagify-price-big">'+e[0]+'</span> <span class="imagify-price-mini">.'+
(1===e[1].length?e[1]+"0":e[1])+'</span></span> <span aria-hidden="'+("yearly"===c?"false":"true")+'" class="imagify-yearly"><span class="imagify-price-big">'+b[0]+'</span> <span class="imagify-price-mini">.'+(1===b[1].length?b[1]+"0":b[1])+"</span></span></span>"}else e=(a+"").split("."),output+='<span class="imagify-price-big">'+e[0]+'</span> <span class="imagify-price-mini">.'+(1===e[1].length?e[1]+"0":e[1])+"</span>";return output},l=function(a,c,d,e){var b=c.additional_gb,f=c.annual_cost,y=c.id,
m=c.label,D=c.monthly_cost,k=c.quota,h=c.cost;c=1E3<=k?k/1E3+" GB":k+" MB";f="monthly"===d?{monthly:D,yearly:Math.round(f/12*100)/100}:h;"undefined"!==typeof e&&a.addClass("imagify-"+d+"-"+m+e);a.find(".imagify-offer-size").text(c);a.find(".imagify-number-block").html(x(f,"monthly"));a.find(".imagify-approx-nb").text(5*k);"monthly"===d&&a.find(".imagify-price-add-data").text("$"+b);(a.find(".imagify-payment-btn-select-plan").length?a.find(".imagify-payment-btn-select-plan"):a).attr("data-offer","monthly"===
d?'{"'+m+'":{"id":'+y+',"name":"'+c+'","data":'+k+',"dataf":"'+c+'","imgs":'+5*k+',"prices":{"monthly":'+f.monthly+',"yearly":'+f.yearly+',"add":'+b+"}}}":'{"ot'+m+'":{"id":'+y+',"name":"'+c+'","data":'+k+',"dataf":"'+c+'","imgs":'+5*k+',"price":'+f+"}}");return a},n=function(){var b=JSON.parse(a(".imagify-offer-monthly").attr("data-offer")),c=JSON.parse(a(".imagify-offer-onetime").attr("data-offer")),d=0,e=0;a(".imagify-offer-monthly").hasClass("imagify-offer-selected")&&(d=a("#imagify-subscription-monthly").filter(":checked").length?
b[Object.keys(b)[0]].prices.monthly:12*b[Object.keys(b)[0]].prices.yearly);a(".imagify-offer-onetime").hasClass("imagify-offer-selected")&&(e=c[Object.keys(c)[0]].price);b=parseFloat(e+d).toFixed(2);a(".imagify-global-amount").text(b);"0.00"==b||0===b?a("#imagify-modal-checkout-btn").attr("disabled","disabled").addClass("imagify-button-disabled"):a("#imagify-modal-checkout-btn").removeAttr("disabled").removeClass("imagify-button-disabled")},E=function(b){b=b.data("nonce");var c={action:"imagify_get_prices",
imagifynonce:b},d={action:"imagify_get_images_counts",imagifynonce:b};w.find(".imagify-modal-loader").hide().show();a.post(ajaxurl,c,function(b){b.success&&a.post(ajaxurl,d,function(c){c=c.data;prices_datas=b.data;monthlies=prices_datas.monthlies;onetimes=prices_datas.onetimes;mo_user_cons=c.average_month_size.raw/1E6;ot_user_cons=c.total_library_size.raw/1E6;$mo_tpl=a("#imagify-offer-monthly-template");$ot_tpl=a("#imagify-offer-onetime-template");ot_clone=$ot_tpl.html();mo_clone=$mo_tpl.html();mo_html=
ot_html="";mo_suggested=ot_suggested=!1;if(null===monthlies||null===onetimes)c=a(".imagify-pre-checkout-offers"),c.hide().attr("aria-hidden",!0),c.closest(".imagify-modal-views").find(".imagify-popin-message").remove(),c.after('<div class="imagify-popin-message imagify-error"><p>'+imagifyAdmin.labels.errorPriceAPI+"</p></div>");else{a.each(monthlies,function(b,c){if("free"===c.label)return!0;var d=a(mo_clone).clone();if(!1!==mo_suggested&&2<b-mo_suggested)return!0;classes="";if(mo_user_cons<c.quota&&
!1===mo_suggested){classes=" imagify-offer-selected";mo_suggested=b;var e=a(".imagify-pre-checkout-offers").find(".imagify-offer-monthly");l(e,c,"monthly")}d=l(d,c,"monthly",classes);mo_html+=d[0].outerHTML});c=a(mo_html).filter(".imagify-offer-selected").prevAll();if(1<c.length){c=c.length-1;var d=a(mo_html);for(i=0;i<c;i++)delete d[i];mo_html="";for(j=0;j<d.length;j++)mo_html+=a("<div/>").append(d[j]).html()}a.each(onetimes,function(b,c){var d=a(ot_clone).clone();classes="";if(ot_user_cons<c.quota&&
!1===ot_suggested){classes=" imagify-offer-selected";ot_suggested=!0;var e=a(".imagify-pre-checkout-offers").find(".imagify-offer-onetime");l(e,c,"onetime")}d=l(d,c,"onetime",classes);ot_html+=d[0].outerHTML});$mo_tpl.parent().find(".imagify-offer-line")&&$mo_tpl.parent().find(".imagify-offer-line").remove();$mo_tpl.before(mo_html);$ot_tpl.parent().find(".imagify-offer-line")&&$ot_tpl.parent().find(".imagify-offer-line").remove();$ot_tpl.before(ot_html)}w.find(".imagify-modal-loader").fadeOut(300)});
n()})},z=function(b){b.each(function(){a(this).is(":checked")?a(this).closest(".imagify-offer-line").addClass("imagify-offer-selected"):a(this).closest(".imagify-offer-line").removeClass("imagify-offer-selected")});n()},A=function(b){b.each(function(){var b=a(this),d;d=b.parent(".imagify-cart-list-switcher").length?b.closest(".imagify-cart"):b.parent(".imagify-small-options").length?b.parent(".imagify-small-options").next(".imagify-pricing-table"):b.closest(".imagify-offer-line");var e=d.find(".imagify-switch-my");
"yearly"===b.val()?(d.addClass("imagify-year-selected").removeClass("imagify-month-selected"),e.find(".imagify-monthly").attr("aria-hidden","true"),e.find(".imagify-yearly").attr("aria-hidden","false")):(d.addClass("imagify-month-selected").removeClass("imagify-year-selected"),e.find(".imagify-monthly").attr("aria-hidden","false"),e.find(".imagify-yearly").attr("aria-hidden","true"))});n();return b},F=function(){var b=a("#imagify-coupon-code").val();if(""!==b){var c=a(".imagify-coupon-text label"),
d=a(".imagify-coupon-section"),e=a("#imagify-get-pricing-modal").data("nonce");a.post(ajaxurl,{action:"imagify_check_coupon",coupon:b,imagifynonce:e},function(a){"false"===a.success?(c.text(imagifyAdmin.labels.errorCouponAPI),d.removeClass("validated").addClass("invalid")):(c.text(a.data.detail),a.data.success?d.removeClass("invalid").addClass("validated"):d.removeClass("validated").addClass("invalid"))})}},q=a(".imagify-offer-line").find(".imagify-checkbox"),B=a(".imagify-payment-modal").find(".imagify-radio-line").find("input");
z(q);A(B.filter(":checked"));setInterval(function(){n()},1E3);q.on("change.imagify",function(){z(a(this))});B.on("change.imagify",function(){A(a(this))});a("#imagify-get-pricing-modal").on("click.imagify-ajax",function(){E(a(this))});var r=a("#imagify-plans-selection-view"),h=a("#imagify-payment-process-view"),p=a("#imagify-pre-checkout-view"),t=a("#imagify-success-view"),q=a(".imagify-choose-another-plan");a("#imagify-coupon-code").on("blur.imagify",function(){F()});r.hide();h.hide();t.hide();q.on("click.imagify",
function(){var b=a(this),c=b.data("imagify-choose");b.closest(".imagify-modal-views").hide().attr("aria-hidden","true");h.hide().attr("aria-hidden","true");r.fadeIn(300).attr("aria-hidden","false");var d=setInterval(function(){r.find('a[href="#imagify-pricing-tab-'+("plan"==c?"monthly":"onetime")+'"]').trigger("click.imagify");clearInterval(d);d=null},60);return!1});w.on("click.imagify",".imagify-payment-btn-select-plan",function(){var b=a(this),c=b.closest(".imagify-offer-line"),d=b.data("offer"),
e=b.attr("data-offer"),g="imagify-pricing-tab-monthly"===b.closest(".imagify-tab-content").attr("id")?!1:!0,f=g?p.find(".imagify-offer-onetime"):p.find(".imagify-offer-monthly"),b=g?null:b.closest(".imagify-pricing-table").hasClass("imagify-month-selected")?"monthly":"yearly",d=g?x(d[Object.keys(d)[0]].price):x(d[Object.keys(d)[0]].prices,b),h=c.find(".imagify-approx-nb").text(),m=c.find(".imagify-offer-size").text(),l=g?"":'<span class="imagify-price-by">'+c.find(".imagify-price-by").text()+"</span>";
r.hide().attr("aria-hidden","true");p.fadeIn(300).attr("aria-hidden","false");f.find(".imagify-number-block").html(d+l);f.find(".imagify-approx-nb").text(h);f.find(".imagify-offer-size").text(m);f.attr("data-offer",e);g||(f.find(".imagify-price-add-data").text(c.find(".imagify-price-add-data").text()),"monthly"===b?f.find("#imagify-subscription-monthly").trigger("click.imagify"):f.find("#imagify-subscription-yearly").trigger("click.imagify"),f.find(".imagify-inline-options").find("input:radio:checked").trigger("change.imagify"));
n();return!1});a("#imagify-modal-checkout-btn").on("click.imagify",function(){if(!a(this).hasClass("imagify-button-disabled")){var b=a(".imagify-offer-monthly"),c=a(".imagify-offer-onetime"),d={};b.hasClass("imagify-year-selected");b.hasClass("imagify-offer-selected")?(d.monthly=JSON.parse(b.attr("data-offer")),a(".imagify-cart-list-my-choice").show(),prices=d.monthly[Object.keys(d.monthly)[0]].prices,save_price=Math.round(1200*(prices.monthly-prices.yearly))/100,a(".imagify-nb-save-per-year").text("$"+
save_price)):a(".imagify-cart-list-my-choice").hide();c.hasClass("imagify-offer-selected")&&(d.onetime=JSON.parse(c.attr("data-offer")));p.hide().attr("aria-hidden","true");h.fadeIn(300).attr("aria-hidden","false").closest(".imagify-modal-content").addClass("imagify-iframe-viewing");d.period=a(".imagify-offer-monthly").hasClass("imagify-month-selected")?"monthly":"yearly";var b=a("#imagify-payment-iframe"),e=b.attr("src"),c=b.data("src"),g=0,f=0;"object"===typeof d?(d.monthly&&(g=d.monthly[Object.keys(d.monthly)[0]].id),
d.onetime&&(f=d.onetime[Object.keys(d.onetime)[0]].id,f=999==f?d.onetime[Object.keys(d.onetime)[0]].data:f),d.period?(a("#imagify-payment-iframe").data("imagify-api"),e=f,f="yearly"===d.period?g:0,d="monthly"===d.period?g:0,g=a("#imagify-coupon-code").val(),g=""===g?"none":g,parseFloat(a(".imagify-global-amount").text()).toFixed(2),c=c+e+"/"+d+"/"+f+"/"+g+"/",$iframeClone=b.clone(),b.remove(),$iframeClone.attr("src",c),h.html($iframeClone)):C.info("No period defined")):"string"===typeof d&&""!==e&&
(tofind="monthly"===d?"yearly":"monthly",e=e.replace(tofind,d),b.attr("src",e));return!1}});a(".imagify-back-to-plans").on("click.imagify",function(){a(this).closest(".imagify-cart-item").hasClass("imagify-cart-item-onetime")?a(".imagify-offer-onetime").find(".imagify-choose-another-plan").trigger("click.imagify"):a(".imagify-offer-monthly").find(".imagify-choose-another-plan").trigger("click.imagify");return!1});window.addEventListener("message",function(b){var c=b.origin||b.originalEvent.origin;
if("https://app.imagify.io"===c||"http://dapp.imagify.io"===c)switch(b.data){case "cancel":a(".imagify-iframe-viewing .close-btn").trigger("click.imagify");a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing");break;case "back":a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing");h.hide();p.fadeIn(200);break;case "success":a(".imagify-iframe-viewing").removeClass("imagify-iframe-viewing"),h.hide(),t.closest(".imagify-modal-content").addClass("imagify-success-viewing"),t.closest(".imagify-modal").attr("aria-labelledby",
"imagify-success-view"),t.fadeIn(200)}},!0)}if(a(".imagify-tabs").length)a(".imagify-tab").on("click.imagify",function(){var b=a(this);if(!b.hasClass("imagify-current")){var c=b.find("a").attr("href")||"#"+b.find("a").attr("aria-controls");b.closest(".imagify-tabs").next(".imagify-tabs-contents").find(".imagify-tab-content").hide().attr("aria-hidden","true");a(c).fadeIn(275).attr("aria-hidden","false");b.closest(".imagify-tabs").find(".imagify-tab").removeClass("imagify-current").attr("aria-selected",
"false");b.addClass("imagify-current").attr("aria-selected","true")}return!1})});
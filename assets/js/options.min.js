window.imagify=window.imagify||{},function(t,a){var s=!1,o=!1;t("#imagify-settings #api_key").on("blur.imagify",function(){var i=t(this),e=i.val();return""!==t.trim(e)&&(t("#check_api_key").val()===e?(t("#imagify-check-api-container").html('<span class="dashicons dashicons-yes"></span> '+imagifyOptions.labels.ValidApiKeyText),!1):(!0===s?o.abort():(t("#imagify-check-api-container").remove(),i.after('<span id="imagify-check-api-container"><span class="imagify-spinner"></span>'+imagifyOptions.labels.waitApiKeyCheckText+"</span>")),s=!0,void(o=t.get(ajaxurl+a.imagify.concat+"action=imagify_check_api_key_validity&api_key="+i.val()+"&imagifycheckapikeynonce="+t("#imagifycheckapikeynonce").val()).done(function(i){i.success?(t("#imagify-check-api-container").remove(),swal({title:imagifyOptions.labels.ApiKeyCheckSuccessTitle,html:imagifyOptions.labels.ApiKeyCheckSuccessText,type:"success",padding:0,customClass:"imagify-sweet-alert"}).then(function(){location.reload()})):t("#imagify-check-api-container").html('<span class="dashicons dashicons-no"></span> '+i.data),s=!1}))))}),t(".imagify-options-line").css("cursor","pointer").on("click.imagify",function(i){"INPUT"!==i.target.nodeName&&t('input[aria-describedby="'+t(this).attr("id")+'"]').trigger("click.imagify")}),t(".imagify-settings th span").on("click.imagify",function(){var i=t(this).parent().next("td").find(":checkbox");1===i.length&&i.trigger("click.imagify")}),t(".imagify-options-line").find("input").on("change.imagify focus.imagify",function(){var i;"checkbox"===this.type&&!this.checked||!(i=t(this).closest(".imagify-options-line").prev("label").prev(":checkbox")).length||i[0].checked||i.prop("checked",!0)}),t('[name="imagify_settings[backup]"]').on("change.imagify",function(){var i=t(this),e=i.siblings("#backup-dir-is-writable"),a={action:"imagify_check_backup_dir_is_writable",_wpnonce:e.data("nonce")};i.is(":checked")?t.getJSON(ajaxurl,a).done(function(i){t.isPlainObject(i)&&i.success&&(i.data.is_writable?e.addClass("hidden"):e.removeClass("hidden"))}):swal({title:imagifyOptions.labels.noBackupTitle,html:imagifyOptions.labels.noBackupText,type:"warning",customClass:"imagify-sweet-alert",padding:0,showCancelButton:!0,cancelButtonText:imagifySwal.labels.cancelButtonText,reverseButtons:!0}).then(function(){e.addClass("hidden")},function(){i.prop("checked",!0)})}),t('[name="imagify_settings[display_webp_method]"]').on("change.imagify init.imagify",function(i){"picture"===i.target.value?t(i.target).closest(".imagify-radio-group").next(".imagify-options-line").removeClass("imagify-faded"):t(i.target).closest(".imagify-radio-group").next(".imagify-options-line").addClass("imagify-faded")}).filter(":checked").trigger("init.imagify")}(jQuery,(document,window)),function(i,s){i.imagifyUser&&s.getJSON(ajaxurl,i.imagifyUser).done(function(t){s.isPlainObject(t)&&t.success&&(t.data.id=null,t.data.plan_id=null,t.data.is=[],s.each(t.data,function(i,e){var a=".imagify-user-"+i.replace(/_/g,"-");0===i.indexOf("is_")?e&&t.data.is.push(a):"is"!==i&&s(a).text(e)}),t.data.is.push("best-plan"),s(t.data.is.join(",")).removeClass("hidden"))})}(window,(document,jQuery)),function(e,i,g){function a(a){var t,s,o,n,l=!1,r=null;a&&(o=g("#imagify-custom-folders-selected"),(n=o.find(".imagify-custom-folder-line")).find('[value="'+a+'"]').length||(a=a.split("#///#"),t=a[1].replace(/\/+$/,"").toLowerCase(),s=e.imagify.template("imagify-custom-folder"),n.each(function(){var i=g(this),e=i.data("path").replace(/\/+$/,"").toLowerCase();return""!==e&&0===t.indexOf(e)?!(l=!0):t<e?(i.before(s({value:a[0],label:a[1]})),n=o.find(".imagify-custom-folder-line"),!(l=!0)):void 0}),l||(o.append(s({value:a[0],label:a[1]})),n=o.find(".imagify-custom-folder-line")),""!==t&&n.each(function(){var i=g(this),e=i.data("path").toLowerCase();null!==r&&0===e.indexOf(r)?i.find(".imagify-custom-folders-remove").trigger("click.imagify"):r=e}),o.next(".hidden").removeClass("hidden")))}imagifyOptions.getFilesTree&&(g("#imagify-add-custom-folder").on("click.imagify",function(){var i=g(this),e=[];i.prop("disabled")||(i.prop("disabled",!0).next("img").attr("aria-hidden","false"),g("#imagify-custom-folders-selected").find("input").each(function(){e.push(this.value)}),g.post(imagifyOptions.getFilesTree,{folder:"/",selected:e},null,"json").done(function(i){i.success?swal({title:imagifyOptions.labels.filesTreeTitle,html:'<div class="imagify-swal-subtitle">'+imagifyOptions.labels.filesTreeSubTitle+'</div><div class="imagify-swal-content"><p class="imagify-folders-information"><i class="dashicons dashicons-info" aria-hidden="true"></i>'+imagifyOptions.labels.cleaningInfo+'</p><ul id="imagify-folders-tree" class="imagify-folders-tree">'+i.data+"</ul></div>",type:"",customClass:"imagify-sweet-alert imagify-swal-has-subtitle  imagify-folders-selection",showCancelButton:!0,padding:0,confirmButtonText:imagifyOptions.labels.confirmFilesTreeBtn,cancelButtonText:imagifySwal.labels.cancelButtonText,reverseButtons:!0}).then(function(){var i=g("#imagify-folders-tree input").serializeArray();i.length&&g.each(i,function(i,e){a(e.value)})}).catch(swal.noop):swal({title:imagifyOptions.labels.error,html:i.data||"",type:"error",padding:0,customClass:"imagify-sweet-alert"})}).fail(function(){swal({title:imagifyOptions.labels.error,type:"error",customClass:"imagify-sweet-alert",padding:0})}).always(function(){i.prop("disabled",!1).next("img").attr("aria-hidden","true")}))}),g(i).on("click.imagify","#imagify-folders-tree [data-folder]",function(){var e=g(this),i=e.nextAll(".imagify-folders-sub-tree"),a=[];e.prop("disabled")||e.siblings(":checkbox").is(":checked")||(e.prop("disabled",!0).addClass("imagify-loading"),i.length?(e.hasClass("imagify-is-open")?(i.addClass("hidden"),e.removeClass(" imagify-is-open")):(i.removeClass("hidden"),e.addClass("imagify-is-open")),e.prop("disabled",!1).removeClass("imagify-loading")):(g("#imagify-custom-folders-selected").find("input").each(function(){a.push(this.value)}),g.post(imagifyOptions.getFilesTree,{folder:e.data("folder"),selected:a},null,"json").done(function(i){i.success?e.addClass("imagify-is-open").parent().append('<ul class="imagify-folders-sub-tree">'+i.data+"</ul>"):swal({title:imagifyOptions.labels.error,html:i.data||"",type:"error",padding:0,customClass:"imagify-sweet-alert"})}).fail(function(){swal({title:imagifyOptions.labels.error,type:"error",padding:0,customClass:"imagify-sweet-alert"})}).always(function(){e.prop("disabled",!1).removeClass("imagify-loading")})))}),g("#imagify-custom-folders").on("click.imagify",".imagify-custom-folders-remove",function(){var i=g(this).closest(".imagify-custom-folder-line").addClass("imagify-will-remove");e.setTimeout(function(){i.remove(),g("#imagify-custom-folders-selected").siblings(".imagify-success.hidden").removeClass("hidden")},750)}),g("#imagify-add-themes-to-custom-folder").on("click.imagify",function(){var i=g(this);a(i.data("theme")),a(i.data("theme-parent")),i.replaceWith("<p>"+imagifyOptions.labels.themesAdded+"</p>")}))}(window,document,jQuery),function(t,a,s){imagifyOptions.bulk&&(t.imagify.optionsBulk={error:!1,working:!1,processIsStopped:!1,$button:null,$progressWrap:null,$progressBar:null,$progressText:null,init:function(){var i,e;this.$missingWebpElement=s(".generate-missing-webp"),this.$missingWebpMessage=s(".generate-missing-webp p"),this.$button=s("#imagify-generate-webp-versions"),this.$progressWrap=this.$button.siblings(".imagify-progress"),this.$progressBar=this.$progressWrap.find(".bar"),this.$progressText=this.$progressBar.find(".percent"),s("#imagify_convert_to_webp").on("change.imagify init.imagify",{imagifyOptionsBulk:this},this.toggleButton).trigger("init.imagify"),this.$button.on("click.imagify",{imagifyOptionsBulk:this},this.maybeLaunchMissingWebpProcess),s(a).on("imagifybeat-send",{imagifyOptionsBulk:this},this.addQueueImagifybeat).on("imagifybeat-tick",{imagifyOptionsBulk:this},this.processQueueImagifybeat).on("imagifybeat-send",this.addRequirementsImagifybeat).on("imagifybeat-tick",{imagifyOptionsBulk:this},this.processRequirementsImagifybeat),!1!==imagifyOptions.bulk.progress_webp.total&&!1!==imagifyOptions.bulk.progress_webp.remaining&&(t.imagify.optionsBulk.error=!1,t.imagify.optionsBulk.working=!0,t.imagify.optionsBulk.processIsStopped=!1,this.$button.prop("disabled",!0).find(".dashicons").addClass("rotate"),t.imagify.beat.interval(15),t.imagify.beat.disableSuspend(),this.$missingWebpMessage.hide().attr("aria-hidden","true"),i=imagifyOptions.bulk.progress_webp.total-imagifyOptions.bulk.progress_webp.remaining,e=Math.floor(i/imagifyOptions.bulk.progress_webp.total*100),this.$progressBar.css("width",e+"%"),this.$progressText.text(i+"/"+imagifyOptions.bulk.progress_webp.total),this.$progressWrap.slideDown().attr("aria-hidden","false").removeClass("hidden"))},toggleButton:function(i){this.checked?i.data.imagifyOptionsBulk.$button.prop("disabled",!1):i.data.imagifyOptionsBulk.$button.prop("disabled",!0)},maybeLaunchMissingWebpProcess:function(i){!i.data.imagifyOptionsBulk||i.data.imagifyOptionsBulk.working||i.data.imagifyOptionsBulk.hasBlockingError(!0)||(i.data.imagifyOptionsBulk.error=!1,i.data.imagifyOptionsBulk.working=!0,i.data.imagifyOptionsBulk.processIsStopped=!1,i.data.imagifyOptionsBulk.$button.prop("disabled",!0).find(".dashicons").addClass("rotate"),t.imagify.beat.interval(15),t.imagify.beat.disableSuspend(),i.data.imagifyOptionsBulk.launchProcess())},addQueueImagifybeat:function(i,e){e[imagifyOptions.bulk.imagifybeatIDs.progress]=imagifyOptions.bulk.contexts},processQueueImagifybeat:function(i,e){var a,t;i.data.imagifyOptionsBulk&&void 0===e[imagifyOptions.bulk.imagifybeatIDs.progress]||(i.data.imagifyOptionsBulk.processIsStopped||0===(e=e[imagifyOptions.bulk.imagifybeatIDs.progress]).remaining?i.data.imagifyOptionsBulk.processFinished():(a=e.total-e.remaining,t=Math.floor(a/e.total*100),i.data.imagifyOptionsBulk.$progressBar.css("width",t+"%"),i.data.imagifyOptionsBulk.$progressText.text(a+"/"+e.total)))},addRequirementsImagifybeat:function(i,e){e[imagifyOptions.bulk.imagifybeatIDs.requirements]=1},processRequirementsImagifybeat:function(i,e){i.data.imagifyOptionsBulk&&void 0===e[imagifyOptions.bulk.imagifybeatIDs.requirements]||(e=e[imagifyOptions.bulk.imagifybeatIDs.requirements],imagifyOptions.bulk.curlMissing=e.curl_missing,imagifyOptions.bulk.editorMissing=e.editor_missing,imagifyOptions.bulk.extHttpBlocked=e.external_http_blocked,imagifyOptions.bulk.apiDown=e.api_down,imagifyOptions.bulk.keyIsValid=e.key_is_valid,imagifyOptions.bulk.isOverQuota=e.is_over_quota)},launchProcess:function(){var a;this.processIsStopped||s.get((a=this).getAjaxUrl("MissingWebp",imagifyOptions.bulk.contexts)).done(function(i){var e;a.processIsStopped||(e=i.data&&i.data.message?i.data.message:imagifyOptions.bulk.ajaxErrorText,i.success?0===i.data.total?a.stopProcess("no-images"):(a.$missingWebpMessage.hide().attr("aria-hidden","true"),a.$progressText.text("0"+(i.data.total?"/"+i.data.total:"")),a.$progressWrap.slideDown().attr("aria-hidden","false").removeClass("hidden")):a.error||a.stopProcess(e))}).fail(function(){a.error||a.stopProcess("get-unoptimized-images")})},processFinished:function(){var i={};!1!==this.error&&(i="invalid-api-key"===this.error?{title:imagifyOptions.bulk.labels.invalidAPIKeyTitle,type:"info"}:"over-quota"===this.error?{title:imagifyOptions.bulk.labels.overQuotaTitle,html:s("#tmpl-imagify-overquota-alert").html(),type:"info",customClass:"imagify-swal-has-subtitle imagify-swal-error-header",showConfirmButton:!1}:"get-unoptimized-images"===this.error?{title:imagifyOptions.bulk.labels.getUnoptimizedImagesErrorTitle,html:imagifyOptions.bulk.labels.getUnoptimizedImagesErrorText,type:"info"}:"no-images"===this.error?{title:imagifyOptions.bulk.labels.nothingToDoTitle,html:imagifyOptions.bulk.labels.nothingToDoText,type:"info"}:"no-backup"===this.error?{title:imagifyOptions.bulk.labels.nothingToDoTitle,html:imagifyOptions.bulk.labels.nothingToDoNoBackupText,type:"info"}:{title:imagifyOptions.bulk.labels.error,html:this.error,type:"info"},this.displayError(i),this.error=!1),this.working=!1,this.processIsStopped=!1,t.imagify.beat.resetInterval(),t.imagify.beat.enableSuspend(),this.$progressWrap.slideUp().attr("aria-hidden","true").addClass("hidden"),this.$progressText.text("0"),this.$missingWebpElement.hide().attr("aria-hidden","true"),this.$button.find(".dashicons").removeClass("rotate")},hasBlockingError:function(i){return i=void 0!==i&&i,imagifyOptions.bulk.curlMissing?(i&&this.displayError({html:imagifyOptions.bulk.labels.curlMissing}),!0):imagifyOptions.bulk.editorMissing?(i&&this.displayError({html:imagifyOptions.bulk.labels.editorMissing}),!0):imagifyOptions.bulk.extHttpBlocked?(i&&this.displayError({html:imagifyOptions.bulk.labels.extHttpBlocked}),!0):imagifyOptions.bulk.apiDown?(i&&this.displayError({html:imagifyOptions.bulk.labels.apiDown}),!0):imagifyOptions.bulk.keyIsValid?!!imagifyOptions.bulk.isOverQuota&&(i&&this.displayError({title:imagifyOptions.bulk.labels.overQuotaTitle,html:s("#tmpl-imagify-overquota-alert").html(),type:"info",customClass:"imagify-swal-has-subtitle imagify-swal-error-header",showConfirmButton:!1}),!0):(i&&this.displayError({title:imagifyOptions.bulk.labels.invalidAPIKeyTitle,type:"info"}),!0)},displayError:function(i,e,a){var t={title:"",html:"",type:"error",customClass:"",width:620,padding:0,showCloseButton:!0,showConfirmButton:!0};(a=s.isPlainObject(i)?s.extend({},t,i):s.extend({},t,{title:i||"",html:e||""},a=a||{})).title=a.title||imagifyOptions.bulk.labels.error,a.customClass+=" imagify-sweet-alert",swal(a).catch(swal.noop)},getAjaxUrl:function(i,e){var a=ajaxurl+t.imagify.concat+"_wpnonce="+imagifyOptions.bulk.ajaxNonce;return(a+="&action="+imagifyOptions.bulk.ajaxActions[i])+("&context="+e.join("_"))},stopProcess:function(i){this.processIsStopped=!0,this.error=i,this.processFinished()}},t.imagify.optionsBulk.init())}(window,document,jQuery),function(o){var t=o.propHooks.checked;o.propHooks.checked={set:function(i,e,a){e=void 0===t?i[a]=e:t(i,e,a);return o(i).trigger("change.imagify"),e}},o(".imagify-select-all").on("click.imagify",function(){var i=o(this),e=i.data("action"),a=i.closest(".imagify-select-all-buttons"),t=a.prev(".imagify-check-group"),s="imagify-is-inactive";if(i.hasClass(s))return!1;a.find(".imagify-select-all").removeClass(s).attr("aria-disabled","false"),i.addClass(s).attr("aria-disabled","true"),t.find(".imagify-row-check").prop("checked",function(){return!o(this).is(":hidden,:disabled")&&"select"===e})}),o(".imagify-check-group .imagify-row-check").on("change.imagify",function(){var i=o(this).closest(".imagify-check-group"),e=i.find(".imagify-row-check"),a=e.filter(":visible:enabled").length,e=e.filter(":visible:enabled:checked").length,i=i.next(".imagify-select-all-buttons"),t="imagify-is-inactive";0===e&&i.find('[data-action="unselect"]').addClass(t).attr("aria-disabled","true"),e===a&&i.find('[data-action="select"]').addClass(t).attr("aria-disabled","true"),e!==a&&0<e&&i.find(".imagify-select-all").removeClass(t).attr("aria-disabled","false")})}((window,document,jQuery));